var experience = {
    experience_user_name_link : "",
    experience_user_name : "Shivam Pal",
    experience_user_image : "http://127.0.0.1:8000/static/images/image1.jpg",
    experience_user_details : "Student at IIT Kanpur, Electrical Engineering",
    experience_group_name_link : "",
    experience_group_name : "Relationship Shits",
    related_tags : ["Happiness", "Love", "Joy"],
    no_helpful : "34",
    no_agree : "23",
    no_disagree : "10",
    comments : [
        {
            comment_user_name_link : "",
            comment_user_name : "Braj Bhushan",
            comment_user_image : "http://127.0.0.1:8000/static/images/image3.jpg",
            comment_user_details : "Student at IIT Kanpur, Electrical Engineering",
            comment_text : "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation",
        },
        {
            comment_user_name_link : "",
            comment_user_name : "Braj Bhushan",
            comment_user_image : "http://127.0.0.1:8000/static/images/image3.jpg",
            comment_user_details : "Student at IIT Kanpur, Electrical Engineering",
            comment_text : "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation",
        },
    ],
};

var question_answer = {
    question_user_name_link : "",
    question_user_name : "Shivam Pal",
    question_user_image : "http://127.0.0.1:8000/static/images/image1.jpg",
    question_user_details : "Student at IIT Kanpur, Electrical Engineering",
    question_group_name_link : "",
    question_group_name : "Relationship Shits",
    related_tags : ["Happiness", "Love", "Joy"],
    question_user : "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua consectetur adipiscing elit, sed do?",
    answers : [
        {
            answer_user_name_link : "",
            answer_user_name : "Braj Bhushan",
            answer_user_image : "http://127.0.0.1:8000/static/images/image3.jpg",
            answer_user_details : "Student at IIT Kanpur, Electrical Engineering",
            answer_text : "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore exercitation ullamco laboris nisi ut aliquip ex ea commodo lorem ipsum, consectetur adipiscing elit, sed do eiusmod tempor",
            no_helpful : "34",
            no_agree : "23",
            no_disagree : "10",
            comments : [
                {
                    comment_user_name_link : "",
                    comment_user_name : "Braj Bhushan",
                    comment_user_image : "http://127.0.0.1:8000/static/images/image3.jpg",
                    comment_user_details : "Student at IIT Kanpur, Electrical Engineering",
                    comment_text : "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation",
                },
                {
                    comment_user_name_link : "",
                    comment_user_name : "Braj Bhushan",
                    comment_user_image : "http://127.0.0.1:8000/static/images/image3.jpg",
                    comment_user_details : "Student at IIT Kanpur, Electrical Engineering",
                    comment_text : "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation",
                },
            ],
        },
        {
            answer_user_name_link : "",
            answer_user_name : "Braj Bhushan",
            answer_user_image : "http://127.0.0.1:8000/static/images/image3.jpg",
            answer_user_details : "Student at IIT Kanpur, Electrical Engineering",
            answer_text : "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore exercitation ullamco laboris nisi ut aliquip ex ea commodo lorem ipsum, consectetur adipiscing elit, sed do eiusmod tempor <a href=''>  see more....</a>",
            no_helpful : "34",
            no_agree : "23",
            no_disagree : "10",
            comments : [
                {
                    comment_user_name_link : "",
                    comment_user_name : "Braj Bhushan",
                    comment_user_image : "http://127.0.0.1:8000/static/images/image3.jpg",
                    comment_user_details : "Student at IIT Kanpur, Electrical Engineering",
                    comment_text : "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation",
                },
                {
                    comment_user_name_link : "",
                    comment_user_name : "Braj Bhushan",
                    comment_user_image : "http://127.0.0.1:8000/static/images/image3.jpg",
                    comment_user_details : "Student at IIT Kanpur, Electrical Engineering",
                    comment_text : "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation",
                },
            ],
        },
    ],
};

var activity = {
    activity_user_name_link : "",
    activity_user_name : "Shivam Pal",
    activity_user_image : "http://127.0.0.1:8000/static/images/image1.jpg",
    activity_user_details : "Student at IIT Kanpur, Electrical Engineering",
    activity_text : "Consectetur adipiscing elit, sed do eiusmod tempor incididunt",
    comments : [
        {
            comment_user_name_link : "",
            comment_user_name : "Braj Bhushan",
            comment_user_image : "http://127.0.0.1:8000/static/images/image3.jpg",
            comment_user_details : "Student at IIT Kanpur, Electrical Engineering",
            comment_text : "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation",
        },
        {
            comment_user_name_link : "",
            comment_user_name : "Braj Bhushan",
            comment_user_image : "http://127.0.0.1:8000/static/images/image3.jpg",
            comment_user_details : "Student at IIT Kanpur, Electrical Engineering",
            comment_text : "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation",
        },
    ],
};


// This is a template for user experience

function user_experience(post){
    var experience_format = [
        // This section is for adding top headings
        '<div class="card-panel row" id="card_panel" class="experience-post-group">',
            '<div class="col s12">',
                '<div>',
                    '<p class="who_posted"><a href="'+ post.experience_user_name_link +'" class="who_posted_name">'+ post.experience_user_name +'</a> shared his experience on <a href="'+ post.experience_group_name_link +'" class="where_posted">'+ post.experience_group_name +'</a></p>',
                '</div>',
                '<div>',
                    '<div class="post-tags">',
                        '<div class="chip no_chip">Related Tags : </div>',
    ].join("\n");
    var no_of_tags = Object.keys(post.related_tags).length;

    for(var i = 0; i < no_of_tags; i++){
        experience_format += [
            // This section is for adding tags in post
            '<div class="chip">'+ post.related_tags[i] +'</div>',
        ]
    }
    experience_format += [                                   
                    '</div>',
                '</div>',
                '<div class="post-user-details-section">',
                    '<div class="post-user-image-section">',
                        '<a href="'+ post.experience_user_name_link +'"><img class="responsive-img post-user-image" src="'+ post.experience_user_image +'"></a>',
                    '</div>',
                    '<div class="post-user-intro-section">',
                        '<a href=""><p class="post-user-name">'+ post.experience_user_name +'</p></a>',
                        '<p class="post-user-details"><i class="fa fa-dot-circle-o" aria-hidden="true"></i> '+ post.experience_user_details +'</p>',
                    '</div>',
                '</div>',
            '</div>',
            '<div class="row col s12 post-section">',
    ].join("\n");

    experience_format += [
                // This section is specifically for adding text
                '<p class="experience-intro">Consectetur adipiscing elit, sed do eiusmod tempor incididunt</p>',
                '<p class="experience-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore exercitation ullamco laboris nisi ut aliquip ex ea commodo lorem ipsum, consectetur adipiscing elit, sed do eiusmod tempor <a href="">  see more....</a></p>',
    ].join("\n");


    experience_format += [
                // This section is for updating reviews
                '<div class="col s12 iconslist" style="padding: 3px;">',
                    '<div class="col s4" style="text-align: center;">',
                        '<a href="">',
                            '<span class="icons">',
                                '<i class="fa fa-comment" aria-hidden="true"></i> Helpful &nbsp;<span class="icon_numbers">'+ post.no_helpful +'</span>',
                            '</span>',
                        '</a>',
                    '</div>',
                    '<div class="col s4" style="text-align: center;">',
                        '<a href="">',
                            '<span class="icons">',
                                '<i class="fa fa-thumbs-up" aria-hidden="true"></i> Agree &nbsp;<span class="icon_numbers">'+ post.no_agree +'</span>',
                            '</span>',
                        '</a>',
                    '</div>',
                    '<div class="col s4" style="text-align: center;">',
                        '<a href="">',
                            '<span class="icons">',
                                '<i class="fa fa-thumbs-down" aria-hidden="true"></i> Disagree &nbsp;<span class="icon_numbers">'+ post.no_disagree +'</span>',
                            '</span>',
                        '</a>',
                    '</div>',
                '</div>',
    ].join("\n");

    no_of_comments = Object.keys(post.comments).length;
    console.log(no_of_comments);

    for(i = 0; i<no_of_comments; i++){
        experience_format +=[
                    // This section is for adding comments
                    '<div class="col s12">',
                        '<div class="comment-section">',
                            '<div class="comment-user-detail-section">',
                                '<div class="comment-user-image-section">',
                                    '<a href="'+ post.comments[i].comment_user_name_link +'"><img class="responsive-img comment-user-image"  src="'+ post.comments[i].comment_user_image +'" alt="User_name"></a>',
                                '</div>',
                                '<div class="comment-user-intro-section">',
                                    '<a href=""><p class="comment-user-name">'+ post.comments[i].comment_user_name +'</p></a>',
                                    '<p class="comment-user-detail"><i class="fa fa-dot-circle-o" aria-hidden="true"></i> '+ post.comments[i].comment_user_details +'</p>',
                                '</div>',
                            '</div>',
                            '<p class="comment-text">'+ post.comments[i].comment_text +'</p>',
                        '</div>',
                    '</div>',
        ].join("\n");
    }

    

    experience_format += [
                // This section is for adding comment
                '<div class="col s12">',
                    '<p class="load-more-comments">Load 54 more comments</p>',
                '</div>',
                '<div class="col s12">',
                    '<div class="user-comment-write-section">',
                        '<div class="comment-write-image">',
                            '<img class="responsive-img comment-write-user-image" src="http://127.0.0.1:8000/static/images/image1.jpg" alt="User_name">',
                        '</div>',
                        '<div class="user-write-comment">',
                            '<a href=""><span class="write-comment">Write your comments on this post...</span></a>',
                        '</div>',
                    '</div>',
                '</div>',
            '</div>',
        '</div>',
    ].join("\n");

    $("#user_timeline_posts").append(experience_format);
}


// This is template for user questiom

function user_question(post){

    var question_format = [
        // This section is for adding top headings
        '<div class="card-panel row" id="card_panel" class="question-post-group">',
            '<div class="col s12">',
                '<div>',
                    '<p class="who_posted"><a href="'+ post.question_user_name_link +'" class="who_posted_name">'+ post.question_user_name +'</a> asked a question on <a href="'+ post.question_group_name_link +'" class="where_posted">'+ post.question_group_name +'</a></p>',
                '</div>',
                '<div>',
                    '<div class="post-tags">',
                        '<div class="chip no_chip">Related Tags : </div>',
    ].join("\n");

    var no_of_tags = Object.keys(post.related_tags).length;

    for(var i = 0; i < no_of_tags; i++){
        question_format += [
            // This section is for adding tags in post
            '<div class="chip">'+ post.related_tags[i] +'</div>',
        ]
    }

    question_format += [                                 
                    '</div>',
                '</div>',
                '<div class="post-user-details-section">',
                    '<div class="post-user-image-section">',
                        '<a href="'+ post.question_user_name_link +'"><img class="responsive-img post-user-image" src="'+ post.question_user_image +'"></a>',
                    '</div>',
                    '<div class="post-user-intro-section">',
                        '<a href=""><p class="post-user-name">'+ post.question_user_name +'</p></a>',
                        '<p class="post-user-details"><i class="fa fa-dot-circle-o" aria-hidden="true"></i> '+ post.question_user_details +'</p>',
                    '</div>',
                '</div>',
            '</div>',
            '<div class="row col s12 post-section">',
                '<p class="question-text">'+ post.question_user +'</p>',
    ].join("\n");

    var no_of_answers = Object.keys(post.answers).length;

    for(i = 0; i < no_of_answers; i++){

        question_format += [
                // This section is for answer
                '<div class="col s12 answer-section">',
                    '<div class="answer-user-details-section">',
                        '<div class="answer-user-image-section">',
                            '<a href="'+ post.answers[i].answer_user_name_link +'"><img class="responsive-img answer-user-image"  src="'+ post.answers[i].answer_user_image +'" alt="User_name"></a>',
                        '</div>',
                        '<div class="answer-user-intro-section">',
                            '<a href="'+ post.answers[i].answer_user_name_link +'"><p class="answer-user-name"> '+ post.answers[i].answer_user_name +'</p></a>',
                            '<p class="answer-user-details"><i class="fa fa-dot-circle-o" aria-hidden="true"></i> '+ post.answers[i].answer_user_details +'</p>',
                        '</div>',
                    '</div>',

                    '<p class="answer-text">'+ post.answers[i].answer_text +'</p>',

                    '<div class="col s12 iconslist" style="padding: 3px;">',
                        '<div class="col s4" style="text-align: center;">',
                            '<span class="icons">',
                                '<i class="fa fa-comment" aria-hidden="true"></i> Helpful &nbsp;<span class="icon_numbers">'+ post.answers[i].no_helpful +'</span>',
                            '</span>',
                        '</div>',
                        '<div class="col s4" style="text-align: center;">',
                            '<span class="icons">',
                                '<i class="fa fa-thumbs-up" aria-hidden="true"></i> Agree &nbsp;<span class="icon_numbers">'+ post.answers[i].no_agree +'</span>',
                            '</span>',
                        '</div>',
                        '<div class="col s4" style="text-align: center;">',
                            '<span class="icons">',
                                '<i class="fa fa-thumbs-down" aria-hidden="true"></i> Disagree &nbsp;<span class="icon_numbers">'+ post.answers[i].no_disagree +'</span>',
                            '</span>',
                        '</div>',
                    '</div>',
        ].join("\n");




        no_of_comments = Object.keys(post.answers[i].comments).length;

        for(var j = 0; j<no_of_comments; j++){
            question_format +=[
                    // This section is for adding comments
                    '<div class="col s12">',
                        '<div class="comment-section">',
                            '<div class="comment-user-detail-section">',
                                '<div class="comment-user-image-section">',
                                    '<a href="'+ post.answers[i].comments[j].comment_user_name_link +'"><img class="responsive-img comment-user-image"  src="'+ post.answers[i].comments[j].comment_user_image +'" alt="User_name"></a>',
                                '</div>',
                                '<div class="comment-user-intro-section">',
                                    '<a href=""><p class="comment-user-name">'+ post.answers[i].comments[j].comment_user_name +'</p></a>',
                                    '<p class="comment-user-detail"><i class="fa fa-dot-circle-o" aria-hidden="true"></i> '+ post.answers[i].comments[j].comment_user_details +'</p>',
                                '</div>',
                            '</div>',
                            '<p class="comment-text">'+ post.answers[i].comments[j].comment_text +'</p>',
                        '</div>',
                    '</div>',
                
            ].join("\n");
        }

        question_format +=[
                '</div>',
                '<div class="col s12">',
                    '<p class="load-more-comments">Load 54 more comments</p>',
                '</div>',
                '<hr class="activity-line">',
        ].join("\n");

    }

    question_format += [
                // This section is for user writing section 
                
                '<div class="col s12">',
                    '<div class="user-comment-write-section">',
                        '<div class="comment-write-image">',
                            '<img class="responsive-img comment-write-user-image" src="http://127.0.0.1:8000/static/images/image1.jpg" alt="User_name">',
                        '</div>',
                        '<div class="user-write-comment">',
                            '<a href=""><span class="write-comment">Write your comments on this post...</span></a>',
                        '</div>',
                    '</div>',
                '</div>',

            '</div>',
        '</div>',
    ].join("\n");

    $("#user_timeline_posts").append(question_format);

}


// This is template for user activity

function user_activity(post){

    var activity_format = [
        '<div class="card-panel row" id="card_panel" class="activity-post-group">',
            '<div class="col s12">',
                '<div>',
                    '<p class="who_posted"><a href="'+ post.activity_user_name_link +'" class="who_posted_name">'+ post.activity_user_name +'</a> shared activity on his timeline </a></p>',
                    '<hr class="activity-line">',
                '</div>',

                '<div class="post-user-details-section">',
                    '<div class="post-user-image-section">',
                        '<a href="'+ post.activity_user_name_link +'"><img class="responsive-img post-user-image" src="'+ post.activity_user_image +'"></a>',
                    '</div>',
                    '<div class="post-user-intro-section">',
                        '<a href="'+ post.activity_user_name_link +'"><p class="post-user-name">'+ post.activity_user_name +'</p></a>',
                        '<p class="post-user-details"><i class="fa fa-dot-circle-o" aria-hidden="true"></i> '+ post.activity_user_details +'</p>',
                    '</div>',
                '</div>',
            '</div>',
            
            '<div class="row col s12 post-section">',
                '<p class="activity-text">'+ post.activity_text +'</p>',

                '<div class="col s12 iconslist">',
                    
                '</div>',
    ].join("\n");

    no_of_comments = Object.keys(post.comments).length;

    for(i = 0; i < no_of_comments; i++){
        activity_format += [

                '<div class="col s12">',
                    '<div class="comment-section">',
                        '<div class="comment-user-detail-section">',
                            '<div class="comment-user-image-section">',
                                '<a href="'+ post.comments[i].comment_user_name_link +'"><img class="responsive-img comment-user-image"  src="'+ post.comments[i].comment_user_image +'" alt="User_name"></a>',
                            '</div>',
                            '<div class="comment-user-intro-section">',
                                '<a href=""><p class="comment-user-name">'+ post.comments[i].comment_user_name +'</p></a>',
                                '<p class="comment-user-detail"><i class="fa fa-dot-circle-o" aria-hidden="true"></i> '+ post.comments[i].comment_user_details +'</p>',
                            '</div>',
                        '</div>',
                        '<p class="comment-text">'+ post.comments[i].comment_text +'</p>',
                    '</div>',
                '</div>',
        ].join("\n");
    }

    
    activity_format +=[
                '<div class="col s12">',
                    '<p class="load-more-comments">Load 54 more comments</p>',
                '</div>',

                '<div class="col s12">',
                    '<div class="user-comment-write-section">',
                        '<div class="comment-write-image">',
                            '<img class="responsive-img comment-write-user-image" src="http://127.0.0.1:8000/static/images/image1.jpg" alt="User_name">',
                        '</div>',
                        '<div class="user-write-comment">',
                            '<a href=""><span class="write-comment">Write your comments on this post...</span></a>',
                        '</div>',
                    '</div>',
                '</div>',

            '</div>',
        '</div>',
    ].join("\n");

    $("#user_timeline_posts").append(activity_format);
}







function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

var csrftoken = getCookie('csrftoken');

function send_post_request(text){
    console.log(text);
    $.ajax({
        // url :  'http://127.0.0.1:8000/post/user_activity/',
        // url :  'http://127.0.0.1:8000/post/return_all_post/',
        type : "GET",
        data : {
            csrfmiddlewaretoken : csrftoken,
        },
        success : function(json) {
            console.log("Its working!!!!");
            console.log(json);
            send_user_post(json);
        },
        error : function(xhr,errmsg,err) {
            console.log(xhr.status + ": " + xhr.responseText);
        }
    });
}


function send_user_post(user_posts){
    no_of_posts = Object.keys(user_posts.all_post).length;
    for(var i = 0; i < no_of_posts; i++){
        console.log(user_posts.all_post[i].post_type)
        if(user_posts.all_post[i].post_type == "experience"){
            user_experience(user_posts.all_post[i]);
        }
        else if(user_posts.all_post[i].post_type == "activity"){
            user_activity(user_posts.all_post[i]);
        }
        else if(user_posts.all_post[i].post_type == "question"){
            console.log("question is working");
            user_question(user_posts.all_post[i]);
        }
        
    }
}


function send_dummy_post(){
    user_experience(experience);
    user_question(question_answer);
    user_activity(activity);
}


function send_latest_post(user_posts){
    $(window).scroll(function(){   
        var x=$(window).scrollTop();
        var y=$(window).height();
        var z=$(document).height();     
        if(x+y >z - 100){
            send_post_request();
        }
    });
}
